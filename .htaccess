<IfModule mod_rewrite.c>
  RewriteEngine On

  # 1) HTTP → HTTPS в один шаг
  RewriteCond %{HTTPS} off
  RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

# 2) Статические ресурсы – кеш на год, immutable
<IfModule mod_headers.c>
  <FilesMatch "\.(css|js|png|jpe?g|gif|webp|svg|ico|woff2?|ttf|eot)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # HTML и другие динамические ответы – короткий кеш
  <FilesMatch "\.(html|php)$">
    Header set Cache-Control "public, max-age=300, must-revalidate"
  </FilesMatch>

  # Служебные файлы – запрет доступа
  <FilesMatch "^(\.env|\.gitignore|\.htaccess)$">
    Require all denied
  </FilesMatch>

  # Security headers
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>
